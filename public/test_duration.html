<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™‚é–“åˆ¶é™æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 20px; }
        .test-case { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .pass { background-color: #d4edda; border-color: #c3e6cb; }
        .fail { background-color: #f8d7da; border-color: #f5c6cb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª æ™‚é–“åˆ¶é™æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
    <p>ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯30åˆ†æ™‚é–“åˆ¶é™æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
    
    <button onclick="runBasicTests()">åŸºæœ¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
    <button onclick="testFileTimeSimulation()">ãƒ•ã‚¡ã‚¤ãƒ«æ™‚é–“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
    
    <div id="results"></div>

    <script>
        const resultsDiv = document.getElementById('results');

        function log(message, isPass = null) {
            const div = document.createElement('div');
            div.className = 'test-case';
            if (isPass === true) div.classList.add('pass');
            if (isPass === false) div.classList.add('fail');
            div.textContent = message;
            resultsDiv.appendChild(div);
        }

        function clearResults() {
            resultsDiv.innerHTML = '';
        }

        // åŸºæœ¬çš„ãªæ™‚é–“ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
        function runBasicTests() {
            clearResults();
            log('ğŸ§ª åŸºæœ¬ãƒ†ã‚¹ãƒˆé–‹å§‹');

            const testCases = [
                { minutes: 25, expected: true, description: '25åˆ† - è¨±å¯ã•ã‚Œã‚‹ã¹ã' },
                { minutes: 30, expected: true, description: '30åˆ† - è¨±å¯ã•ã‚Œã‚‹ã¹ã' },
                { minutes: 30.5, expected: false, description: '30åˆ†30ç§’ - æ‹’å¦ã•ã‚Œã‚‹ã¹ã' },
                { minutes: 45, expected: false, description: '45åˆ† - æ‹’å¦ã•ã‚Œã‚‹ã¹ã' },
                { minutes: 0.5, expected: true, description: '30ç§’ - è¨±å¯ã•ã‚Œã‚‹ã¹ã' },
                { minutes: 60, expected: false, description: '60åˆ† - æ‹’å¦ã•ã‚Œã‚‹ã¹ã' }
            ];

            testCases.forEach(testCase => {
                const result = testCase.minutes <= 30;
                const passed = result === testCase.expected;
                
                log(`${passed ? 'âœ…' : 'âŒ'} ${testCase.description} - ${result ? 'è¨±å¯' : 'æ‹’å¦'}`, passed);
            });

            log('ğŸ§ª åŸºæœ¬ãƒ†ã‚¹ãƒˆå®Œäº†');
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«æ™‚é–“è¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆ
        function testFileTimeSimulation() {
            clearResults();
            log('â±ï¸ ãƒ•ã‚¡ã‚¤ãƒ«æ™‚é–“è¡¨ç¤ºãƒ†ã‚¹ãƒˆé–‹å§‹');

            const testTimes = [29.5, 30.1, 45.7, 62.3];
            
            testTimes.forEach(durationMinutes => {
                const currentTime = `${Math.floor(durationMinutes)}åˆ†${Math.floor((durationMinutes % 1) * 60)}ç§’`;
                const wouldPass = durationMinutes <= 30;
                
                if (!wouldPass) {
                    const message = `ãƒ•ã‚¡ã‚¤ãƒ«ã®æ™‚é–“ãŒåˆ¶é™ã‚’è¶…ãˆã¦ã„ã¾ã™\n\nç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: ${currentTime}\nåˆ¶é™æ™‚é–“: 30åˆ†\n\n30åˆ†ä»¥å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚`;
                    log(`âŒ ${durationMinutes}åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«: "${currentTime}" - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¢ºèª`, false);
                } else {
                    log(`âœ… ${durationMinutes}åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«: "${currentTime}" - è¨±å¯`, true);
                }
            });

            log('â±ï¸ ãƒ•ã‚¡ã‚¤ãƒ«æ™‚é–“è¡¨ç¤ºãƒ†ã‚¹ãƒˆå®Œäº†');
        }

        // å®Ÿéš›ã®getFileDurationé–¢æ•°ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
        function simulateGetFileDuration(fakeDurationMinutes) {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve(fakeDurationMinutes * 60); // ç§’ã«å¤‰æ›
                }, 100);
            });
        }

        // å®Ÿéš›ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        async function simulateFileUpload(fakeDurationMinutes) {
            log(`ğŸ“ ${fakeDurationMinutes}åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆä¸­...`);
            
            try {
                const durationSeconds = await simulateGetFileDuration(fakeDurationMinutes);
                const durationMinutes = durationSeconds / 60;
                
                console.log(`File duration: ${durationMinutes.toFixed(2)} minutes`);
                
                // æ™‚é–“åˆ¶é™ãƒã‚§ãƒƒã‚¯ï¼ˆ30åˆ†åˆ¶é™ï¼‰
                if (durationMinutes > 30) {
                    const currentTime = `${Math.floor(durationMinutes)}åˆ†${Math.floor((durationMinutes % 1) * 60)}ç§’`;
                    const errorMessage = `ãƒ•ã‚¡ã‚¤ãƒ«ã®æ™‚é–“ãŒåˆ¶é™ã‚’è¶…ãˆã¦ã„ã¾ã™\n\nç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: ${currentTime}\nåˆ¶é™æ™‚é–“: 30åˆ†\n\n30åˆ†ä»¥å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚`;
                    log(`âŒ æ‹’å¦: ${errorMessage}`, false);
                    return false;
                } else {
                    log(`âœ… è¨±å¯: ${durationMinutes.toFixed(2)}åˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«`, true);
                    return true;
                }
            } catch (error) {
                log(`âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, false);
                return false;
            }
        }

        // è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        setTimeout(() => {
            log('ğŸš€ è‡ªå‹•ãƒ†ã‚¹ãƒˆé–‹å§‹');
            runBasicTests();
        }, 500);
    </script>
</body>
</html>